import numpy as np 
from ase.eos import EquationOfState
from ase.units import kJ,kB,fs

print(kJ,kB,fs)

import matplotlib.pyplot as plt 


e2 = np.asarray([-4989.838110481004, -4989.865171853136, -4989.9149474992455, -4989.985341599618, -4990.072947159527, -4990.172748891196, -4990.277965021287, -4990.379840006558, -4990.4676148558265, -4990.5287485488925, -4990.54953338616, -4990.516165142146, -4990.4163869096765, -4990.241344076037, -4989.987322236497, -4989.657129005615, -4989.26129650286, -4988.818686291531, -4988.355965943832, -4987.904075508048])
v2 = np.asarray([20.1777,20.1660,20.1253,20.0560,19.9578,19.83152,19.67756,19.4974,19.2922,19.0641,18.814,18.54717,18.2628,17.9641,17.653,17.3311,16.9996,16.6611,15.8677,15.9999])

e3 = [v for i, v in enumerate(e2) if i % 2 == 0]
v3 = [v for i, v in enumerate(v2) if i % 2 == 0]


e4 = [-4989.838110481004, -4989.872090537679, -4989.92840036149, -4990.00475513948, -4990.0976156937095, -4990.202099406768, -4990.311812745147, -4990.418734525133, -4990.512978344146, -4990.582499900111, -4990.612766462719, -4990.5864586388725, -4990.483674520345, -4990.283220042619, -4989.965420128454, -4989.516920359128, -4988.9380578081145, -4988.253262827761, -4987.518736244003, -4986.813293642589]
v4 = [20.0779,19.968,19.8319,19.669,19.4796,19.2642,19.0343,18.8096,18.5698,18.3155,18.0477,17.7675,17.476,17.174,16.863,17.02,16.2191,15.8865,15.5478,15.20324]
print(len(v4))
print(len(e4))

e5 = [-4989.838110481004, -4989.848098039343, -4989.8818780814645, -4989.940917502235, -4990.025524491709, -4990.134959640604, -4990.267358543643, -4990.419712226929, -4990.587680133758, -4990.76552515557, -4990.945942291316, -4991.119812181926, -4991.275656472479, -4991.3987291034555, -4991.469745588126, -4991.464225100478, -4991.354364809266, -4991.115440268705, -4990.7365326275685, -4990.232339663014]
v5 = [20.42645,20.6673,20.8829,21.0728,21.2361,21.3729,21.4827,21.5784,21.6780,21.7588,21.8204,21.8630,21.8864,21.89124,21.8775,21.84561,21.7957,21.7282,21.64350,21.54159]



e3 = [v for i, v in enumerate(e4) if i % 2 == 0]
v3 = [v for i, v in enumerate(v4) if i % 2 == 0]

e3_ = [v for i, v in enumerate(e3) if i % 2 != 0]
v3_ = [v for i, v in enumerate(v3) if i % 2 != 0]









#print(e*0.0734986176)

eos = EquationOfState(v3[:],e3[:])
#eos = EquationOfState(v5,e5)
v0,e0,B = eos.fit()
print(v0,e0,B/kJ * 1e24)

#print([(a,b) for a,b in zip(v[4:-1],e[4:-7]*0.0734986176)])
fig = plt.figure(figsize = (7,4),dpi =150)
#plt.plot(v[4:-1],e[4:-7],'.:b')
plt.xlabel('volume[Ä³]')
plt.ylabel('energy [eV]')
plt.title('E-v')
fig.tight_layout()
plt.grid('True')  
eos.plot('eos_try.png')  
plt.show()